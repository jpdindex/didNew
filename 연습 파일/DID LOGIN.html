<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>DID Analysis</title>
    <style>
        /* 1. ê³µí†µ ë°°ê²½ ì„¤ì • */
        body { 
            margin: 0; width: 100%; height: 100vh; 
            display: flex; justify-content: center; align-items: center; 
            background-color: #121212;
            background-size: cover; background-position: center; background-repeat: no-repeat;
            font-family: 'Pretendard', -apple-system, sans-serif;
            transition: all 0.5s ease;
        }

        /* 2. ë¡œê·¸ì¸ ì„¹ì…˜ */
        #login-section {
            background: #1e1e1e; padding: 40px; border-radius: 15px; 
            width: 350px; text-align: center; border: 1px solid #333;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #login-section h2 { color: white; margin-bottom: 30px; }
        input { 
            width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #333; 
            border-radius: 8px; font-size: 16px; background: #2d2d2d; color: white; box-sizing: border-box; 
        }
        button.login-btn { 
            width: 100%; padding: 15px; background: #007bff; color: white; border: none; 
            border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px;
        }

        /* 3. ì¼ì • ì„ íƒ ì„¹ì…˜ */
        #schedule-section {
            display: none; /* ì²˜ìŒì—” ìˆ¨ê¹€ */
            width: 90%; max-width: 800px; height: 85vh;
            background: rgba(20, 20, 20, 0.95); border-radius: 20px;
            padding: 30px; box-sizing: border-box; overflow-y: auto;
            border: 1px solid #444; backdrop-filter: blur(15px);
        }
        .header { text-align: center; margin-bottom: 30px; color: white; position: relative; }
        
        /* ë‚ ì§œ ì„ íƒë°” */
        .date-selector { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 20px; margin-bottom: 20px; border-bottom: 1px solid #333; }
        .date-item {
            min-width: 70px; height: 90px; background: #2a2a2a; border-radius: 12px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; border: 1px solid #444; color: #fff; transition: 0.3s;
        }
        .date-item.active { background: #007bff; border-color: #007bff; transform: translateY(-5px); }
        .date-item span { font-size: 12px; color: #aaa; margin-bottom: 5px; }

        /* ê²½ê¸° ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ */
        .match-card {
            background: #252525; margin-bottom: 15px; padding: 20px;
            border-radius: 12px; display: flex; justify-content: space-between; align-items: center;
            border: 1px solid #333; color: white; cursor: pointer; transition: 0.2s;
        }
        .match-card:hover { background: #333; border-color: #007bff; }
        
        .team-wrap { display: flex; align-items: center; gap: 15px; width: 220px; }
        .team-logo { width: 45px; height: 45px; background: #fff; border-radius: 50%; object-fit: contain; padding: 3px; }
        .team-name { font-size: 18px; font-weight: bold; }
        .match-time { font-size: 20px; color: #f1c40f; font-weight: bold; text-align: center; flex: 1; }
        
        /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ */
        .back-btn { position: absolute; left: 0; top: 5px; background: none; border: 1px solid #555; color: #ccc; padding: 5px 12px; border-radius: 5px; cursor: pointer; }

        /* 4. ë¼ì¸ì—… ì„¹ì…˜ */
        #lineup-section {
            display: none;
            width: 95%; max-width: 1000px; height: 90vh;
            background: rgba(15, 15, 15, 0.98); border-radius: 20px;
            padding: 30px; box-sizing: border-box; overflow-y: auto;
            border: 1px solid #007bff; color: white;
        }
        .lineup-header { display: flex; justify-content: space-around; align-items: center; margin-bottom: 40px; border-bottom: 2px solid #333; padding-bottom: 20px; }
        .squad-wrapper { display: flex; gap: 30px; justify-content: space-between; }
        .squad-container { flex: 1; background: #1a1a1a; padding: 20px; border-radius: 15px; border: 1px solid #333; }
        .squad-title { font-size: 22px; font-weight: bold; margin-bottom: 20px; text-align: center; color: #007bff; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .player-list { list-style: none; padding: 0; }
        .player-item { 
            display: flex; justify-content: space-between; padding: 12px 15px; border-bottom: 1px solid #2a2a2a;
            font-size: 18px; transition: 0.2s;
        }
        .player-item:hover { background: #333; transform: scale(1.02); }
        .back-no { color: #f1c40f; font-weight: bold; width: 30px; }
        .pos { font-size: 14px; color: #888; margin-left: 10px; }
    </style>
</head>
<body>

    <div id="login-section">
        <h2>âš½ DID LOGIN</h2>
        <input type="text" id="u_id" placeholder="ê´€ë¦¬ì ì•„ì´ë””">
        <input type="password" id="u_pw" placeholder="ë¹„ë°€ë²ˆí˜¸">
        <button class="login-btn" onclick="handleLogin()">ë¡œê·¸ì¸</button>
    </div>

    <div id="schedule-section">
        <div class="header">
            <button class="back-btn" onclick="goBack()">â¬… ë’¤ë¡œ</button>
            <h2>ğŸ“… ê²½ê¸° ì¼ì • ì„ íƒ</h2>
        </div>
        
        <div class="date-selector" id="date-bar">
            <div class="date-item" onclick="selectDate(this)"><span>ì›”</span><strong>23</strong></div>
            <div class="date-item" onclick="selectDate(this)"><span>í™”</span><strong>24</strong></div>
            <div class="date-item active" onclick="selectDate(this)"><span>ìˆ˜</span><strong>25</strong></div>
            <div class="date-item" onclick="selectDate(this)"><span>ëª©</span><strong>26</strong></div>
            <div class="date-item" onclick="selectDate(this)"><span>ê¸ˆ</span><strong>27</strong></div>
            <div class="date-item" onclick="selectDate(this)"><span>í† </span><strong>28</strong></div>
            <div class="date-item" onclick="selectDate(this)"><span>ì¼</span><strong>29</strong></div>
        </div>

        <div class="match-list" id="match-list-container">
            </div>
    </div>

    <div id="lineup-section">
        <div class="header" style="position: relative;">
            <button class="back-btn" onclick="goBackToSchedule()">â¬… ì¼ì •ìœ¼ë¡œ</button>
            <h2 id="lineup-match-title">ë¼ì¸ì—… ì •ë³´</h2>
        </div>
        <div class="lineup-header">
            <div style="text-align: center;">
                <img id="home-logo" src="" class="team-logo" style="width: 80px; height: 80px; margin-bottom: 10px;">
                <div id="home-name" style="font-size: 24px; font-weight: bold;">í™ˆíŒ€</div>
            </div>
            <div style="font-size: 40px; font-weight: bold; color: #555;">VS</div>
            <div style="text-align: center;">
                <img id="away-logo" src="" class="team-logo" style="width: 80px; height: 80px; margin-bottom: 10px;">
                <div id="away-name" style="font-size: 24px; font-weight: bold;">ì›ì •íŒ€</div>
            </div>
        </div>
        <div class="squad-wrapper">
            <div class="squad-container">
                <div class="squad-title">STARTING XI (Home)</div>
                <ul class="player-list" id="home-player-list"></ul>
            </div>
            <div class="squad-container">
                <div class="squad-title">STARTING XI (Away)</div>
                <ul class="player-list" id="away-player-list"></ul>
            </div>
        </div>
    </div>

    <script>
        // --- 1. ë°°ê²½ ì„¤ì • ---
        const bgImages = [
            'https://images.unsplash.com/photo-1574629810360-7efbbe195018?q=80&w=1920',
            'https://images.unsplash.com/photo-1508098682722-e99c43a406b2?q=80&w=1920',
            'https://images.unsplash.com/photo-1522778119026-d647f0596c20?q=80&w=1920'
        ];

        function setRandomBackground() {
            const randomIndex = Math.floor(Math.random() * bgImages.length);
            document.body.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('${bgImages[randomIndex]}')`;
        }

        // --- 2. ê²½ê¸° ë°ì´í„° (ë¡œê³  ê²½ë¡œ í¬í•¨, íŒ€ ì½”ë“œ ì¶”ê°€) ---
        const matchData = {
            "23": [{ t1: "ìš¸ì‚° HD", t1_code: "ULSAN", t2: "ì „ë¶ í˜„ëŒ€", t2_code: "JEONBUK", time: "14:00", l1: "ulsan.png", l2: "jeonbuk.png" }],
            "24": [{ t1: "ëŒ€êµ¬ FC", t1_code: "DAEGU", t2: "ê´‘ì£¼ FC", t2_code: "GWANGJU", time: "19:00", l1: "daegu.png", l2: "gwangju.png" }],
            "25": [
                { t1: "FCì„œìš¸", t1_code: "SEOUL", t2: "ìˆ˜ì› ì‚¼ì„± ë¸”ë£¨ìœ™ì¦ˆ", t2_code: "SUWON", time: "17:30", l1: "seoul.jpg", l2: "suwon.jpg" },
                { t1: "í¬í•­ ìŠ¤í‹¸ëŸ¬ìŠ¤", t1_code: "POHANG", t2: "ê°•ì› FC", t2_code: "GANGWON", time: "20:00", l1: "pohang.png", l2: "gangwon.png" }
            ],
            "28": [{ t1: "ì œì£¼ ìœ ë‚˜ì´í‹°ë“œ", t1_code: "JEJU", t2: "ì¸ì²œ ìœ ë‚˜ì´í‹°ë“œ", t2_code: "INCHEON", time: "16:00", l1: "jeju.png", l2: "incheon.png" }]
        };

        // --- 3. í•µì‹¬ í•¨ìˆ˜ë“¤ ---

        // ë¡œê·¸ì¸ ì²˜ë¦¬
        function handleLogin() {
            const id = document.getElementById('u_id').value;
            const pw = document.getElementById('u_pw').value;
            if (id && pw) {
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('schedule-section').style.display = 'block';
                renderMatches("25"); // ê¸°ë³¸ìœ¼ë¡œ ìˆ˜ìš”ì¼(25ì¼) ê²½ê¸° í‘œì‹œ
            } else {
                alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            }
        }

        // ë’¤ë¡œê°€ê¸°
        function goBack() {
            document.getElementById('schedule-section').style.display = 'none';
            document.getElementById('login-section').style.display = 'block';
        }

        function goBackToSchedule() {
            document.getElementById('lineup-section').style.display = 'none';
            document.getElementById('schedule-section').style.display = 'block';
        }

        // ë‚ ì§œ ì„ íƒ ì‹œ
        function selectDate(element) {
            const items = document.querySelectorAll('.date-item');
            items.forEach(item => item.classList.remove('active'));
            element.classList.add('active');

            const day = element.querySelector('strong').innerText;
            renderMatches(day);
        }

        // ê²½ê¸° ëª©ë¡ ê·¸ë¦¬ê¸°
        function renderMatches(day) {
            const container = document.getElementById('match-list-container');
            const matches = matchData[day] || [];
            
            if (matches.length === 0) {
                container.innerHTML = `<div style="text-align:center; color:#888; padding:50px;">í•´ë‹¹ ë‚ ì§œì—ëŠ” ê²½ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
                return;
            }

            let html = "";
            matches.forEach(m => {
                html += `
                    <div class="match-card" onclick='showLineup(${JSON.stringify(m)})'>
                        <div class="team-wrap">
                            <img src="images/${m.l1}" class="team-logo" alt="logo">
                            <div class="team-name">${m.t1}</div>
                        </div>
                        <div class="match-time">${m.time}</div>
                        <div class="team-wrap" style="justify-content: flex-end;">
                            <div class="team-name">${m.t2}</div>
                            <img src="images/${m.l2}" class="team-logo" alt="logo">
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // ë¼ì¸ì—… ë³´ê¸° (ì„œë²„ í†µì‹  ë²„ì „)
        async function showLineup(match) {
            // 1. í™”ë©´ ì „í™˜ ë° ë¡œë”©
            document.getElementById('schedule-section').style.display = 'none';
            document.getElementById('lineup-section').style.display = 'block';
            
            document.getElementById('lineup-match-title').innerText = `${match.t1} vs ${match.t2}`;
            document.getElementById('home-name').innerText = match.t1;
            document.getElementById('away-name').innerText = match.t2;
            document.getElementById('home-logo').src = `images/${match.l1}`;
            document.getElementById('away-logo').src = `images/${match.l2}`;

            const homeList = document.getElementById('home-player-list');
            const awayList = document.getElementById('away-player-list');

            // ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™” (ë¡œë”© ì¤‘ í‘œì‹œ)
            homeList.innerHTML = `<li class="player-item" style="justify-content:center;">ë¡œë”© ì¤‘...</li>`;
            awayList.innerHTML = `<li class="player-item" style="justify-content:center;">ë¡œë”© ì¤‘...</li>`;

            try {
                // 2. ì„œë²„ ìš”ì²­ (mock_api.php)
                const formData = new FormData();
                formData.append('func', 'player_list');
                formData.append('h_t_code', match.t1_code); // ì˜ˆ: SEOUL
                formData.append('a_t_code', match.t2_code); // ì˜ˆ: SUWON
                formData.append('gm_date', '2025.12.25');

                // ì£¼ì˜: PHP ì„œë²„ê°€ ì—†ìœ¼ë©´ ì—¬ê¸°ì„œ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.
                const response = await fetch('mock_api.php', {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (data.result === true) {
                    // 3. ë°›ì•„ì˜¨ ë°ì´í„° ë¶„ë¥˜ ë° ì¶œë ¥
                    const allPlayers = data.output;
                    const homeSquad = allPlayers.filter(p => p.t_code === match.t1_code);
                    const awaySquad = allPlayers.filter(p => p.t_code === match.t2_code);

                    renderPlayerList(homeList, homeSquad);
                    renderPlayerList(awayList, awaySquad);
                } else {
                    homeList.innerHTML = `<li>ë°ì´í„° ì—†ìŒ: ${data.message}</li>`;
                    awayList.innerHTML = `<li>ë°ì´í„° ì—†ìŒ</li>`;
                }

            } catch (error) {
                console.error("ì„œë²„ í†µì‹  ì—ëŸ¬:", error);
                const msg = "ì„œë²„ ì—°ê²° ì‹¤íŒ¨ (PHP ë¯¸ì„¤ì¹˜)";
                homeList.innerHTML = `<li class="player-item" style="color:red; justify-content:center;">${msg}</li>`;
                awayList.innerHTML = `<li class="player-item" style="color:red; justify-content:center;">${msg}</li>`;
                
                // ì—°ìŠµìš©: ì—ëŸ¬ê°€ ë‚˜ë”ë¼ë„ 'mock_api.php'ê°€ ì—†ì–´ì„œ ê·¸ëŸ° ê²ƒì´ë‹ˆ,
                // ì½”ë“œê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì„¤ëª…í•˜ëŠ” ì•Œë¦¼ì„ ë„ì›ë‹ˆë‹¤.
                alert("í˜„ì¬ PHP ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì´ì§€ ì•Šì•„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n(ì½”ë“œëŠ” ì •ìƒì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹¤ì œ ì„œë²„ í™˜ê²½ì—ì„œëŠ” ì„ ìˆ˜ ëª…ë‹¨ì´ í‘œì‹œë©ë‹ˆë‹¤.)");
            }
        }

        function renderPlayerList(element, players) {
            if (!players || players.length === 0) {
                element.innerHTML = `<li class="player-item">ë“±ë¡ëœ ì„ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</li>`;
                return;
            }
            let html = "";
            players.forEach(p => {
                // API ì‘ë‹µ í•„ë“œëª…(back_no)ì— ë§ì¶° ìˆ˜ì •
                html += `
                    <li class="player-item">
                        <div><span class="back-no">${p.back_no}</span> ${p.name} <span class="pos">${p.position}</span></div>
                    </li>
                `;
            });
            element.innerHTML = html;
        }

        // ì´ˆê¸° ì‹¤í–‰
        window.onload = setRandomBackground;
    </script>
</body>
</html>